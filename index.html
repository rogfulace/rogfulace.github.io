<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DMEC | Death Investigation Report</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
  <style>
    body { background-color: #242a2f; }
  </style>
</head>

<body>
<div class="container mt-5">
  <div class="row">
    <!-- LEFT COLUMN FORM -->
    <div class="col-md-6">
      <div class="card">
        <div class="card-body">
          <center><h5 class="card-title">Los Santos County Department of Medical Examiner-Coroner</h5></center>
          <center><img src="https://cdn.discordapp.com/attachments/465675591538966548/1120088728455614614/coroner.png" width="150px"></center>
          
          <!-- JOB TITLE -->
          <div class="form-group">
            <label for="jobtitle">Job Classification</label>
            <select class="form-control" id="jobtitle">
              <option value="" selected disabled>Please Select</option>
              <option value="F">Forensic Attendant</option>
              <option value="C">Coroner Investigator</option>
              <option value="M">Medical Examiner</option>
            </select>
          </div>
          
          <!-- TYPE OF DEATH -->
          <div class="form-group">
            <label for="typeofdeath">Type of Death</label>
            <select class="form-control" id="typeofdeath">
              <option value="" selected disabled>Please Select</option>
              <option value="CK">CK</option>
              <option value="PK">PK</option>
            </select>
          </div>

          <!-- DATE + TIME -->
          <div class="form-group">
            <label for="datetime">Date</label>
            <input type="text" id="datetime" class="form-control" style="text-transform: uppercase;" placeholder="DD/MMM/YYYY">
          </div>
          <div class="form-group">
            <label for="time">Time of Report</label>
            <input type="text" id="time" class="form-control" style="text-transform: uppercase;" placeholder="HH:MM">
          </div>

          <!-- CORONER -->
          <div class="form-group">
            <label for="coronername">Handling Coroner</label>
            <input type="text" id="coronername" class="form-control" placeholder="Coroner(s) Names">
          </div>

          <!-- REQUESTING AGENCY -->
          <div class="form-group">
            <label for="requestingagency">Requesting Agency</label>
            <select class="form-control" id="requestingagency">
              <option value="" selected disabled>Please Select</option>
              <option value="FD">LSFD</option>
              <option value="PD">LSPD</option>
              <option value="SD">LSSD</option>
              <option value="PHMC">PHMC</option>
              <option value="PR">SAPR</option>
            </select>
          </div>

          <!-- BADGE + VICTIM -->
          <div class="form-group">
            <label for="coronerbadge">Coroner Serial Number</label>
            <input type="text" id="coronerbadge" class="form-control" placeholder="Coroner(s) Serial Numbers">
          </div>
          <div class="form-group">
            <label for="victimname">Victim</label>
            <input type="text" id="victimname" class="form-control" placeholder="John Doe">
          </div>
          <div class="form-group">
            <label for="victimnameooc">Victim Name ((OOC))</label>
            <input type="text" id="victimnameooc" class="form-control" placeholder="John Doe">
          </div>

          <!-- DEATH DETAILS -->
          <div class="form-group">
            <label for="timeofdeath">Pronounced Time of Death</label>
            <input type="text" id="timeofdeath" class="form-control" style="text-transform: uppercase;" placeholder="HH:MM">
          </div>
          <div class="form-group">
            <label for="placeofdeath">Place of Death</label>
            <input type="text" id="placeofdeath" class="form-control" placeholder="Los Santos">
          </div>
          <div class="form-group">
            <label for="causeofdeath">Probable Cause of Death</label>
            <textarea class="form-control" id="causeofdeath"></textarea>
          </div>
          <div class="form-group">
            <label for="mannerofdeath">Manner of Death</label>
            <select class="form-control" id="mannerofdeath">
              <option value="" selected disabled>Please Select</option>
              <option value="Natural">Natural</option>
              <option value="Accident">Accident</option>
              <option value="Suicide">Suicide</option>
              <option value="Homicide">Homicide</option>
              <option value="Undetermined">Undetermined</option>
            </select>
          </div>

          <!-- SYNOPSIS -->
          <div class="form-group">
            <label for="narrative">Synopsis</label>
            <textarea class="form-control" id="narrative"></textarea>
          </div>

          <!-- IMAGES -->
          <div class="form-group">
            <label for="images">Scene Photography (comma separated)</label>
            <textarea class="form-control" id="images"></textarea>
          </div>
          <div class="form-group">
            <label for="morguescreen">Morgue Screen, CInjuries, CDNA (comma separated)</label>
            <textarea class="form-control" id="morguescreen"></textarea>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT COLUMN BBCode -->
    <div class="col-md-6">
      <div class="card">
        <div class="card-body">
          <button class="btn btn-secondary mt-3" onclick="copy_data('bbtitle')">Copy Title</button>
          <button class="btn btn-primary mt-3" onclick="copy_data('bbcode')">Copy Code</button>

          <h5 class="card-title">Report Title</h5>
          <p id="bbtitle">[<span id="deathText1">CK</span>] - <span id="victimText1">JOHN DOE</span> ((<span id="victimnameoocText">JOHN DOE</span>)) - <span id="datetimetext1">02/SEP/2025</span></p>

          <h5 class="card-title">Copy BBCode</h5>
          <pre id="bbcode" style="white-space: pre-wrap; font-size: 12px;"></pre>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
$(document).ready(function(){
  // Set default date
  var currentDate = moment.utc().format('DD/MMM/YYYY').toUpperCase();
  $("#datetime").val(currentDate);
  $("#datetimetext1").text(currentDate);
  $("#datetimetext2").text(currentDate);

  function updateBBCode() {
    let bb = `[divbox=white][img]https://cdn.discordapp.com/attachments/742936416832585728/971008079586009138/165157674249549858.png[/img]
[aligntable=right,0,000,0,0,0,transparent][size=90]OPERATIONS DIVISION
DECEDENT SERVICES
[hr][/hr][/aligntable]

[center] DEATH INVESTIGATION REPORT[/center]
[hr][/hr]

[center][b]A. WRITTEN REPORT[/b][/center]

The County Coroner's Office was called regarding the decease at [b]${$("#placeofdeath").val() || "[Place of Death]"}[/b]. Upon receiving the call from [b]${$("#requestingagencyText").text() || "[Requesting Agency]"}[/b], a ${$("#jobText1").text()} was dispatched on [b]${$("#datetime").val()}[/b] at [b]${$("#time").val()}[/b].

${$("#jobText2").text()}, [b]${$("#coronername").val()}[/b], Serial Number [b]${$("#coronerbadge").val()}[/b], identified the victim as [b]${$("#victimname").val()}[/b], pronounced dead at [b]${$("#timeofdeath").val()}[/b]. Synopsis: ${$("#narrative").val()}

Probable cause: [b]${$("#causeofdeath").val()}[/b]. Manner: [b]${$("#mannerofdeath").val()}[/b].

[center][b]B. PHOTOGRAPHIC RECORD[/b][/center]
[customspoiler=SCENE PHOTOGRAPHY]${$("#images").val().split(",").map(x=>`[img]${x.trim()}[/img]`).join("")}[/customspoiler]

[divbox=transparent][center][b][u](( OUT OF CHARACTER ))[/u][/b][/center][hr][/hr]
This was a ${$("#typeofdeath").val()}.
Morgue: ${$("#morguescreen").val().split(",").map(x=>`[img]${x.trim()}[/img]`).join("")}[/divbox]`;
    
    $("#bbcode").text(bb);
  }

  // Attach events
  $("input, textarea, select").on("input change", updateBBCode);
  updateBBCode();
});

// Copy function
function copy_data(id) {
  let el = document.getElementById(id);
  let range = document.createRange();
  range.selectNode(el);
  window.getSelection().removeAllRanges();
  window.getSelection().addRange(range);
  document.execCommand("copy");
  window.getSelection().removeAllRanges();
  alert("Copied!");
}
</script>
</body>
</html>
